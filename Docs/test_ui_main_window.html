<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test_ui_main_window</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><details><summary>app</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="__main__.html">__main__</a></li><li><a href="config.html">config</a></li><li><a href="logging.html">logging</a></li><li><details><summary>ingest</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="preview.html">preview</a></li><li><a href="service.html">service</a></li><li><details><summary>parsers</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="docx_parser.html">docx_parser</a></li><li><a href="markdown_parser.html">markdown_parser</a></li><li><a href="pdf_parser.html">pdf_parser</a></li><li><a href="text_parser.html">text_parser</a></li></ul></details></li></ul></details></li><li><details><summary>retrieval</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="index.html">index</a></li><li><a href="search.html">search</a></li></ul></details></li><li><details><summary>services</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="backup_service.html">backup_service</a></li><li><a href="conversation_manager.html">conversation_manager</a></li><li><a href="conversation_settings.html">conversation_settings</a></li><li><a href="document_hierarchy.html">document_hierarchy</a></li><li><a href="export_service.html">export_service</a></li><li><a href="lmstudio_client.html">lmstudio_client</a></li><li><a href="progress_service.html">progress_service</a></li><li><a href="project_service.html">project_service</a></li><li><a href="settings_service.html">settings_service</a></li></ul></details></li><li><details><summary>storage</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="database.html">database</a></li></ul></details></li><li><details><summary>ui</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="answer_view.html">answer_view</a></li><li><a href="evidence_panel.html">evidence_panel</a></li><li><a href="main_window.html">main_window</a></li><li><a href="question_input_widget.html">question_input_widget</a></li></ul></details></li></ul></details></li><li><details><summary>tests</summary><ul><li><a href="test_dynamic_planning.html">test_dynamic_planning</a></li><li><a href="test_export_and_backup.html">test_export_and_backup</a></li><li><a href="test_ingest_service.html">test_ingest_service</a></li><li><a href="test_lmstudio_integration.html">test_lmstudio_integration</a></li><li><a href="test_parser_file_types.html">test_parser_file_types</a></li><li><a href="test_preview_service.html">test_preview_service</a></li><li><a href="test_project_service.html">test_project_service</a></li><li><a href="test_retrieval_index.html">test_retrieval_index</a></li><li><a href="test_search_service.html">test_search_service</a></li><li><a href="test_storage.html">test_storage</a></li><li><a href="test_ui_main_window.html">test_ui_main_window</a></li></ul></details></li></ul>
    </div>
    <div class="content">
        <h1>test_ui_main_window</h1>
        <p>This module defines UI tests for the DataMiner main window, using PyQt6 for the interface and pytest for testing. It includes fixtures for setting up a Qt application instance and test-specific services such as settings, project, and progress management. Tests cover the layout and behavior of the main window&#x27;s splitter, ingest file patterns, theme and font persistence, submission flow with reasoning verbosity controls, evidence panel interactions including requerying and previewing, and opening files in system applications. A dummy LMStudio client is used to simulate AI responses during testing. The tests validate UI elements, service interactions, and user workflows within the application&#x27;s graphical interface.</p>
<h2 id="DummyLMStudioClient">Class: DummyLMStudioClient</h2>
<p>The `DummyLMStudioClient` class is a deterministic stub designed for UI interaction testing, mimicking an LMStudio client with fixed responses. It tracks the last messages, options, and call count, and returns a consistent `ChatMessage` object with predefined reasoning, citations, and metadata on each `chat` invocation. The `health_check` method always returns `True`, indicating the client is operational.</p>
<h3 id="__init__">Method: __init__(self) -&gt; None</h3>
<p>Initializes the `DummyLMStudioClient` instance with attributes to track messages, options, call count, and the last question.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>last_messages: <span style="color: #008000">list</span>[<span style="color: #008000">dict</span>] <span style="color: #666666">=</span> []
        <span style="color: #008000">self</span><span style="color: #666666">.</span>last_options: <span style="color: #008000">dict</span> <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>calls <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>last_question: <span style="color: #008000">str</span> <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
</code></pre>
<h3 id="health_check">Method: health_check(self) -&gt; bool</h3>
<p>The `health_check` method of the `DummyLMStudioClient` class always returns `True`, indicating a successful health status. This implementation is a placeholder that does not perform any actual health verification.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">health_check</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">bool</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">True</span>
</code></pre>
<h3 id="chat">Method: chat(self, messages, *, preset, extra_options=None) -&gt; ChatMessage</h3>
<p>The `chat` method of the `DummyLMStudioClient` class simulates a language model interaction by returning a predefined response. It stores the input messages and options, increments an internal call counter, and extracts the last message&#x27;s content as the question. The method constructs a mock response containing reasoning steps, assumptions, self-check results, and citations. These elements are included in the returned `ChatMessage` object along with the deterministic answer content, metadata, and token usage statistics.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">chat</span>(<span style="color: #008000">self</span>, messages, <span style="color: #666666">*</span>, preset, extra_options<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> ChatMessage:  <span style="color: #3D7B7B; font-style: italic"># type: ignore[override]</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>last_messages <span style="color: #666666">=</span> <span style="color: #008000">list</span>(messages)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>last_options <span style="color: #666666">=</span> extra_options <span style="color: #AA22FF; font-weight: bold">or</span> {}
        <span style="color: #008000">self</span><span style="color: #666666">.</span>calls <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
        <span style="color: #008000; font-weight: bold">if</span> messages:
            last <span style="color: #666666">=</span> messages[<span style="color: #666666">-1</span>]
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(last, <span style="color: #008000">dict</span>):
                <span style="color: #008000">self</span><span style="color: #666666">.</span>last_question <span style="color: #666666">=</span> <span style="color: #008000">str</span>(last<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;content&quot;</span>, <span style="color: #BA2121">&quot;&quot;</span>))
        reasoning <span style="color: #666666">=</span> {
            <span style="color: #BA2121">&quot;summary_bullets&quot;</span>: [<span style="color: #BA2121">&quot;Reviewed document A for relevant data.&quot;</span>],
            <span style="color: #BA2121">&quot;plan&quot;</span>: [
                {<span style="color: #BA2121">&quot;description&quot;</span>: <span style="color: #BA2121">&quot;Search repository&quot;</span>, <span style="color: #BA2121">&quot;status&quot;</span>: <span style="color: #BA2121">&quot;complete&quot;</span>},
                {<span style="color: #BA2121">&quot;description&quot;</span>: <span style="color: #BA2121">&quot;Summarize findings&quot;</span>, <span style="color: #BA2121">&quot;status&quot;</span>: <span style="color: #BA2121">&quot;pending&quot;</span>},
            ],
            <span style="color: #BA2121">&quot;assumptions&quot;</span>: {
                <span style="color: #BA2121">&quot;used&quot;</span>: [<span style="color: #BA2121">&quot;Assumed latest dataset applies&quot;</span>],
                <span style="color: #BA2121">&quot;decision&quot;</span>: <span style="color: #BA2121">&quot;assume&quot;</span>,
                <span style="color: #BA2121">&quot;rationale&quot;</span>: <span style="color: #BA2121">&quot;No timeframe specified&quot;</span>,
            },
            <span style="color: #BA2121">&quot;self_check&quot;</span>: {
                <span style="color: #BA2121">&quot;passed&quot;</span>: <span style="color: #008000; font-weight: bold">True</span>,
                <span style="color: #BA2121">&quot;flags&quot;</span>: [<span style="color: #BA2121">&quot;Validated citations&quot;</span>],
                <span style="color: #BA2121">&quot;notes&quot;</span>: <span style="color: #BA2121">&quot;No issues detected&quot;</span>,
            },
        }
        citations <span style="color: #666666">=</span> [
            {
                <span style="color: #BA2121">&quot;id&quot;</span>: <span style="color: #BA2121">&quot;doc-a&quot;</span>,
                <span style="color: #BA2121">&quot;source&quot;</span>: <span style="color: #BA2121">&quot;Doc A&quot;</span>,
                <span style="color: #BA2121">&quot;snippet&quot;</span>: <span style="color: #BA2121">&quot;&lt;mark&gt;Metric&lt;/mark&gt; value is 42.&quot;</span>,
                <span style="color: #BA2121">&quot;page&quot;</span>: <span style="color: #666666">5</span>,
                <span style="color: #BA2121">&quot;section&quot;</span>: <span style="color: #BA2121">&quot;Summary&quot;</span>,
                <span style="color: #BA2121">&quot;path&quot;</span>: <span style="color: #BA2121">&quot;/tmp/doc_a.txt&quot;</span>,
            },
            {
                <span style="color: #BA2121">&quot;id&quot;</span>: <span style="color: #BA2121">&quot;doc-b&quot;</span>,
                <span style="color: #BA2121">&quot;source&quot;</span>: <span style="color: #BA2121">&quot;Doc B&quot;</span>,
                <span style="color: #BA2121">&quot;snippet&quot;</span>: <span style="color: #BA2121">&quot;Supporting details from Doc B.&quot;</span>,
                <span style="color: #BA2121">&quot;page&quot;</span>: <span style="color: #666666">2</span>,
                <span style="color: #BA2121">&quot;section&quot;</span>: <span style="color: #BA2121">&quot;Context&quot;</span>,
                <span style="color: #BA2121">&quot;path&quot;</span>: <span style="color: #BA2121">&quot;/tmp/doc_b.txt&quot;</span>,
            },
        ]
        metadata <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;citations&quot;</span>: citations, <span style="color: #BA2121">&quot;reasoning&quot;</span>: reasoning}
        raw_response <span style="color: #666666">=</span> {
            <span style="color: #BA2121">&quot;choices&quot;</span>: [
                {
                    <span style="color: #BA2121">&quot;message&quot;</span>: {
                        <span style="color: #BA2121">&quot;content&quot;</span>: <span style="color: #BA2121">&quot;Deterministic answer [1] references evidence [2] as well.&quot;</span>,
                        <span style="color: #BA2121">&quot;metadata&quot;</span>: metadata,
                    }
                }
            ],
            <span style="color: #BA2121">&quot;usage&quot;</span>: {<span style="color: #BA2121">&quot;prompt_tokens&quot;</span>: <span style="color: #666666">12</span>, <span style="color: #BA2121">&quot;completion_tokens&quot;</span>: <span style="color: #666666">24</span>, <span style="color: #BA2121">&quot;total_tokens&quot;</span>: <span style="color: #666666">36</span>},
        }
        <span style="color: #008000; font-weight: bold">return</span> ChatMessage(
            content<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Deterministic answer [1] references evidence [2] as well.&quot;</span>,
            citations<span style="color: #666666">=</span>citations,
            reasoning<span style="color: #666666">=</span>reasoning,
            raw_response<span style="color: #666666">=</span>raw_response,
        )
</code></pre>
<h2>Functions</h2>
<h3 id="qt_app">qt_app() -&gt; QApplication</h3>
<p>The function `qt_app` returns the existing QApplication instance if one already exists, or creates a new QApplication instance if none exists. It ensures that only one QApplication instance is active within the application lifecycle.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">qt_app</span>() <span style="color: #666666">-&gt;</span> QApplication:
    app <span style="color: #666666">=</span> QApplication<span style="color: #666666">.</span>instance()
    <span style="color: #008000; font-weight: bold">if</span> app <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
        app <span style="color: #666666">=</span> QApplication([])
    <span style="color: #008000; font-weight: bold">return</span> app
</code></pre>
<h3 id="build_settings_service">build_settings_service(tmp_path, monkeypatch) -&gt; SettingsService</h3>
<p>Creates and returns a `SettingsService` instance configured with a temporary path for XDG configuration home, using a `ConfigManager` initialized with the application name &quot;DataMinerTest&quot; and configuration file &quot;ui.json&quot;.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">build_settings_service</span>(tmp_path, monkeypatch) <span style="color: #666666">-&gt;</span> SettingsService:
    monkeypatch<span style="color: #666666">.</span>setenv(<span style="color: #BA2121">&quot;XDG_CONFIG_HOME&quot;</span>, <span style="color: #008000">str</span>(tmp_path))
    manager <span style="color: #666666">=</span> ConfigManager(app_name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;DataMinerTest&quot;</span>, filename<span style="color: #666666">=</span><span style="color: #BA2121">&quot;ui.json&quot;</span>)
    <span style="color: #008000; font-weight: bold">return</span> SettingsService(config_manager<span style="color: #666666">=</span>manager)
</code></pre>
<h3 id="project_service">project_service(tmp_path, monkeypatch) -&gt; ProjectService</h3>
<p>Creates and yields a `ProjectService` instance configured with a temporary path for storage and configuration. Sets the `XDG_CONFIG_HOME` environment variable to the provided temporary path, initializes a `ConfigManager` with a test application name and projects file, and constructs the `ProjectService` using the temporary storage root and configuration manager. Yields the service for use in tests, then shuts down the service after the test completes.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">project_service</span>(tmp_path, monkeypatch) <span style="color: #666666">-&gt;</span> ProjectService:
    monkeypatch<span style="color: #666666">.</span>setenv(<span style="color: #BA2121">&quot;XDG_CONFIG_HOME&quot;</span>, <span style="color: #008000">str</span>(tmp_path))
    config <span style="color: #666666">=</span> ConfigManager(app_name<span style="color: #666666">=</span><span style="color: #BA2121">&quot;DataMinerTest&quot;</span>, filename<span style="color: #666666">=</span><span style="color: #BA2121">&quot;projects.json&quot;</span>)
    service <span style="color: #666666">=</span> ProjectService(storage_root<span style="color: #666666">=</span>tmp_path <span style="color: #666666">/</span> <span style="color: #BA2121">&quot;storage&quot;</span>, config_manager<span style="color: #666666">=</span>config)
    <span style="color: #008000; font-weight: bold">yield</span> service
    service<span style="color: #666666">.</span>shutdown()
</code></pre>
<h3 id="test_main_window_splitter_layout">test_main_window_splitter_layout(qt_app, tmp_path, monkeypatch, project_service)</h3>
<p>This function tests the layout and initial state of the main application window&#x27;s splitter component. It creates a `MainWindow` instance with specified services and verifies that the window contains a `QSplitter` with three child widgets, checks that the splitter&#x27;s size distribution meets certain conditions, and ensures that specific buttons are present and in the expected state. The test confirms the splitter layout and button states after the window is initialized and resized.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_main_window_splitter_layout</span>(qt_app, tmp_path, monkeypatch, project_service):
    settings_service <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    progress_service <span style="color: #666666">=</span> ProgressService()
    lmstudio_client <span style="color: #666666">=</span> LMStudioClient()
    export_service <span style="color: #666666">=</span> ExportService()
    backup_service <span style="color: #666666">=</span> BackupService(project_service)
    window <span style="color: #666666">=</span> MainWindow(
        settings_service<span style="color: #666666">=</span>settings_service,
        progress_service<span style="color: #666666">=</span>progress_service,
        lmstudio_client<span style="color: #666666">=</span>lmstudio_client,
        project_service<span style="color: #666666">=</span>project_service,
        export_service<span style="color: #666666">=</span>export_service,
        backup_service<span style="color: #666666">=</span>backup_service,
        enable_health_monitor<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
    )
    window<span style="color: #666666">.</span>resize(<span style="color: #666666">1400</span>, <span style="color: #666666">900</span>)
    qt_app<span style="color: #666666">.</span>processEvents()
    splitter <span style="color: #666666">=</span> window<span style="color: #666666">.</span>findChild(QSplitter)
    <span style="color: #008000; font-weight: bold">assert</span> splitter <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    <span style="color: #008000; font-weight: bold">assert</span> splitter<span style="color: #666666">.</span>count() <span style="color: #666666">==</span> <span style="color: #666666">3</span>
    sizes <span style="color: #666666">=</span> splitter<span style="color: #666666">.</span>sizes()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">sum</span>(sizes) <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">assert</span> sizes[<span style="color: #666666">1</span>] <span style="color: #666666">&gt;=</span> sizes[<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> sizes[<span style="color: #666666">1</span>] <span style="color: #666666">&gt;=</span> sizes[<span style="color: #666666">2</span>]
    index_button <span style="color: #666666">=</span> window<span style="color: #666666">.</span>findChild(QPushButton, <span style="color: #BA2121">&quot;indexFolderButton&quot;</span>)
    <span style="color: #008000; font-weight: bold">assert</span> index_button <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    rescan_button <span style="color: #666666">=</span> window<span style="color: #666666">.</span>findChild(QPushButton, <span style="color: #BA2121">&quot;rescanCorpusButton&quot;</span>)
    <span style="color: #008000; font-weight: bold">assert</span> rescan_button <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #AA22FF; font-weight: bold">not</span> rescan_button<span style="color: #666666">.</span>isEnabled()
    window<span style="color: #666666">.</span>close()
</code></pre>
<h3 id="test_main_window_ingest_patterns_match_parsers">test_main_window_ingest_patterns_match_parsers(qt_app, tmp_path, monkeypatch, project_service) -&gt; None</h3>
<p>The function `test_main_window_ingest_patterns_match_parsers` tests that the main window&#x27;s ingest include patterns and file filter specification match the supported patterns. It creates a `MainWindow` instance with mocked services, retrieves the ingest patterns and filter specification, and asserts that they align with `SUPPORTED_PATTERNS`. The window is closed after the test executes.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_main_window_ingest_patterns_match_parsers</span>(
    qt_app, tmp_path, monkeypatch, project_service
) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
    settings_service <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    progress_service <span style="color: #666666">=</span> ProgressService()
    lmstudio_client <span style="color: #666666">=</span> LMStudioClient()
    export_service <span style="color: #666666">=</span> ExportService()
    backup_service <span style="color: #666666">=</span> BackupService(project_service)
    window <span style="color: #666666">=</span> MainWindow(
        settings_service<span style="color: #666666">=</span>settings_service,
        progress_service<span style="color: #666666">=</span>progress_service,
        lmstudio_client<span style="color: #666666">=</span>lmstudio_client,
        project_service<span style="color: #666666">=</span>project_service,
        export_service<span style="color: #666666">=</span>export_service,
        backup_service<span style="color: #666666">=</span>backup_service,
        enable_health_monitor<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
    )
    <span style="color: #008000; font-weight: bold">try</span>:
        patterns <span style="color: #666666">=</span> window<span style="color: #666666">.</span>_ingest_include_patterns()
        <span style="color: #008000; font-weight: bold">assert</span> patterns <span style="color: #666666">==</span> <span style="color: #008000">list</span>(SUPPORTED_PATTERNS)

        filter_spec <span style="color: #666666">=</span> window<span style="color: #666666">.</span>_ingest_file_filter_spec()
        <span style="color: #008000; font-weight: bold">for</span> pattern <span style="color: #AA22FF; font-weight: bold">in</span> SUPPORTED_PATTERNS:
            <span style="color: #008000; font-weight: bold">assert</span> pattern <span style="color: #AA22FF; font-weight: bold">in</span> filter_spec
    <span style="color: #008000; font-weight: bold">finally</span>:
        window<span style="color: #666666">.</span>close()
</code></pre>
<h3 id="test_settings_persist_theme_and_font">test_settings_persist_theme_and_font(tmp_path, monkeypatch)</h3>
<p>The function tests that theme and font scale settings are persisted between service instances. It creates a settings service, sets the theme to &quot;dark&quot; and font scale to 1.5, then rebuilds the service from the same temporary path. It verifies that the reloaded service maintains the previously set theme and font scale values, ensuring proper persistence of user preferences.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_settings_persist_theme_and_font</span>(tmp_path, monkeypatch):
    settings_service <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    settings_service<span style="color: #666666">.</span>set_theme(<span style="color: #BA2121">&quot;dark&quot;</span>)
    settings_service<span style="color: #666666">.</span>set_font_scale(<span style="color: #666666">1.5</span>)

    reloaded <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    <span style="color: #008000; font-weight: bold">assert</span> reloaded<span style="color: #666666">.</span>theme <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;dark&quot;</span>
    <span style="color: #008000; font-weight: bold">assert</span> reloaded<span style="color: #666666">.</span>font_scale <span style="color: #666666">==</span> pytest<span style="color: #666666">.</span>approx(<span style="color: #666666">1.5</span>)
</code></pre>
<h3 id="test_submission_flow_and_controls">test_submission_flow_and_controls(qt_app, tmp_path, monkeypatch, project_service)</h3>
<p>The function `test_submission_flow_and_controls` tests the end-to-end behavior of a question-answering interface within a document processing application. It simulates user interactions with the main window, including submitting questions, toggling UI controls for reasoning sections, adjusting verbosity settings, and enabling sources-only responses. The test verifies that the application correctly displays answer cards with associated metadata, citations, reasoning sections, and plan/assumption visibility based on user settings. It also checks clipboard functionality for copying answers, citations, and conversation history. The test uses a dummy language model client to simulate AI responses and ensures that request options are properly configured according to UI selections. Finally, it confirms the application&#x27;s ability to manage multiple query submissions and handle window closure.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_submission_flow_and_controls</span>(qt_app, tmp_path, monkeypatch, project_service):
    settings_service <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    progress_service <span style="color: #666666">=</span> ProgressService()
    client <span style="color: #666666">=</span> DummyLMStudioClient()
    export_service <span style="color: #666666">=</span> ExportService()
    backup_service <span style="color: #666666">=</span> BackupService(project_service)
    window <span style="color: #666666">=</span> MainWindow(
        settings_service<span style="color: #666666">=</span>settings_service,
        progress_service<span style="color: #666666">=</span>progress_service,
        lmstudio_client<span style="color: #666666">=</span>client,
        project_service<span style="color: #666666">=</span>project_service,
        export_service<span style="color: #666666">=</span>export_service,
        backup_service<span style="color: #666666">=</span>backup_service,
        enable_health_monitor<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
    )

    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>set_text(<span style="color: #BA2121">&quot;What is the latest metric?&quot;</span>)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()

    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(window<span style="color: #666666">.</span>answer_view<span style="color: #666666">.</span>cards) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    first_card <span style="color: #666666">=</span> window<span style="color: #666666">.</span>answer_view<span style="color: #666666">.</span>cards[<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">assert</span> first_card<span style="color: #666666">.</span>question_label<span style="color: #666666">.</span>text()<span style="color: #666666">.</span>endswith(<span style="color: #BA2121">&quot;What is the latest metric?&quot;</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Deterministic answer&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> first_card<span style="color: #666666">.</span>answer_browser<span style="color: #666666">.</span>toPlainText()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Doc A&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> first_card<span style="color: #666666">.</span>citations_browser<span style="color: #666666">.</span>toPlainText()
    <span style="color: #008000; font-weight: bold">assert</span> first_card<span style="color: #666666">.</span>reasoning_section<span style="color: #666666">.</span>isVisible()
    <span style="color: #008000; font-weight: bold">assert</span> first_card<span style="color: #666666">.</span>plan_section<span style="color: #666666">.</span>isVisible()
    <span style="color: #008000; font-weight: bold">assert</span> first_card<span style="color: #666666">.</span>assumptions_section<span style="color: #666666">.</span>isVisible()
    <span style="color: #008000; font-weight: bold">assert</span> first_card<span style="color: #666666">.</span>self_check_section<span style="color: #666666">.</span>isVisible()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Latency&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> first_card<span style="color: #666666">.</span>metadata_label<span style="color: #666666">.</span>text()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Prompt Tokens&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> first_card<span style="color: #666666">.</span>metadata_label<span style="color: #666666">.</span>text()
    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>last_options <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    reasoning_options <span style="color: #666666">=</span> client<span style="color: #666666">.</span>last_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;reasoning&quot;</span>, {})
    <span style="color: #008000; font-weight: bold">assert</span> reasoning_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;verbosity&quot;</span>) <span style="color: #666666">==</span> ReasoningVerbosity<span style="color: #666666">.</span>BRIEF<span style="color: #666666">.</span>value
    <span style="color: #008000; font-weight: bold">assert</span> reasoning_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;include_plan&quot;</span>) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">True</span>
    <span style="color: #008000; font-weight: bold">assert</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>evidence_count <span style="color: #666666">==</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">assert</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>evidence_items[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>label<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&quot;[1] Doc A&quot;</span>)

    window<span style="color: #666666">.</span>_plan_checkbox<span style="color: #666666">.</span>setChecked(<span style="color: #008000; font-weight: bold">False</span>)
    window<span style="color: #666666">.</span>_assumptions_checkbox<span style="color: #666666">.</span>setChecked(<span style="color: #008000; font-weight: bold">False</span>)
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #AA22FF; font-weight: bold">not</span> first_card<span style="color: #666666">.</span>plan_section<span style="color: #666666">.</span>isVisible()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #AA22FF; font-weight: bold">not</span> first_card<span style="color: #666666">.</span>assumptions_section<span style="color: #666666">.</span>isVisible()
    window<span style="color: #666666">.</span>_plan_checkbox<span style="color: #666666">.</span>setChecked(<span style="color: #008000; font-weight: bold">True</span>)
    window<span style="color: #666666">.</span>_assumptions_checkbox<span style="color: #666666">.</span>setChecked(<span style="color: #008000; font-weight: bold">True</span>)
    qt_app<span style="color: #666666">.</span>processEvents()

    minimal_index <span style="color: #666666">=</span> window<span style="color: #666666">.</span>_verbosity_combo<span style="color: #666666">.</span>findData(ReasoningVerbosity<span style="color: #666666">.</span>MINIMAL)
    window<span style="color: #666666">.</span>_verbosity_combo<span style="color: #666666">.</span>setCurrentIndex(minimal_index)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>set_text(<span style="color: #BA2121">&quot;Summarize context&quot;</span>)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(window<span style="color: #666666">.</span>answer_view<span style="color: #666666">.</span>cards) <span style="color: #666666">==</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>last_options <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    reasoning_options <span style="color: #666666">=</span> client<span style="color: #666666">.</span>last_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;reasoning&quot;</span>, {})
    <span style="color: #008000; font-weight: bold">assert</span> reasoning_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;verbosity&quot;</span>) <span style="color: #666666">==</span> ReasoningVerbosity<span style="color: #666666">.</span>MINIMAL<span style="color: #666666">.</span>value
    <span style="color: #008000; font-weight: bold">assert</span> reasoning_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;include_plan&quot;</span>) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">False</span>

    window<span style="color: #666666">.</span>_sources_only_checkbox<span style="color: #666666">.</span>setChecked(<span style="color: #008000; font-weight: bold">True</span>)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>set_text(<span style="color: #BA2121">&quot;Only sources please&quot;</span>)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">len</span>(window<span style="color: #666666">.</span>answer_view<span style="color: #666666">.</span>cards) <span style="color: #666666">==</span> <span style="color: #666666">3</span>
    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>last_options <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>last_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;response_mode&quot;</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;sources_only&quot;</span>

    latest_card <span style="color: #666666">=</span> window<span style="color: #666666">.</span>answer_view<span style="color: #666666">.</span>cards[<span style="color: #666666">-1</span>]
    latest_card<span style="color: #666666">.</span>copy_answer_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> QApplication<span style="color: #666666">.</span>clipboard()<span style="color: #666666">.</span>text() <span style="color: #666666">==</span> latest_card<span style="color: #666666">.</span>answer_browser<span style="color: #666666">.</span>toPlainText()

    latest_card<span style="color: #666666">.</span>copy_citations_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Doc A&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> QApplication<span style="color: #666666">.</span>clipboard()<span style="color: #666666">.</span>text()

    window<span style="color: #666666">.</span>_copy_chat_text()
    qt_app<span style="color: #666666">.</span>processEvents()
    copied_conversation <span style="color: #666666">=</span> QApplication<span style="color: #666666">.</span>clipboard()<span style="color: #666666">.</span>text()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;What is the latest metric?&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> copied_conversation
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Only sources please&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> copied_conversation

    window<span style="color: #666666">.</span>close()
</code></pre>
<h3 id="test_evidence_scope_requery_and_preview">test_evidence_scope_requery_and_preview(qt_app, tmp_path, monkeypatch, project_service)</h3>
<p>This function tests the behavior of evidence scope requerying and preview functionality within a document processing application. It sets up a test environment with a dummy language model client, initializes a main window with associated services, and simulates user interactions such as asking a question, selecting evidence, and excluding documents from retrieval. The test verifies that the client is called a specific number of times, checks the evidence panel&#x27;s state and content, ensures citations are correctly handled, and confirms that document exclusion and inclusion parameters are properly passed to the retrieval options when a document is excluded. Finally, it closes the application window.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_evidence_scope_requery_and_preview</span>(qt_app, tmp_path, monkeypatch, project_service):
    settings_service <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    progress_service <span style="color: #666666">=</span> ProgressService()
    client <span style="color: #666666">=</span> DummyLMStudioClient()
    export_service <span style="color: #666666">=</span> ExportService()
    backup_service <span style="color: #666666">=</span> BackupService(project_service)
    window <span style="color: #666666">=</span> MainWindow(
        settings_service<span style="color: #666666">=</span>settings_service,
        progress_service<span style="color: #666666">=</span>progress_service,
        lmstudio_client<span style="color: #666666">=</span>client,
        project_service<span style="color: #666666">=</span>project_service,
        export_service<span style="color: #666666">=</span>export_service,
        backup_service<span style="color: #666666">=</span>backup_service,
        enable_health_monitor<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
    )

    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>set_text(<span style="color: #BA2121">&quot;Explain the metric&quot;</span>)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()

    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>calls <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>evidence_count <span style="color: #666666">==</span> <span style="color: #666666">2</span>

    window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>select_index(<span style="color: #666666">0</span>)
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Metric&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>evidence_items[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>snippet_html
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;Page 5&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>_metadata_label<span style="color: #666666">.</span>text()

    first_card <span style="color: #666666">=</span> window<span style="color: #666666">.</span>answer_view<span style="color: #666666">.</span>cards[<span style="color: #666666">0</span>]
    first_card<span style="color: #666666">.</span>citations_browser<span style="color: #666666">.</span>anchorClicked<span style="color: #666666">.</span>emit(QUrl(<span style="color: #BA2121">&quot;cite-2&quot;</span>))
    qt_app<span style="color: #666666">.</span>processEvents()
    <span style="color: #008000; font-weight: bold">assert</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>selected_index <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> first_card<span style="color: #666666">.</span>selected_citation <span style="color: #666666">==</span> <span style="color: #666666">2</span>

    row_widget <span style="color: #666666">=</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>_list<span style="color: #666666">.</span>itemWidget(window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>_list<span style="color: #666666">.</span>item(<span style="color: #666666">0</span>))
    row_widget<span style="color: #666666">.</span>exclude_button<span style="color: #666666">.</span>setChecked(<span style="color: #008000; font-weight: bold">True</span>)
    qt_app<span style="color: #666666">.</span>processEvents()

    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>calls <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">assert</span> client<span style="color: #666666">.</span>last_options <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    retrieval <span style="color: #666666">=</span> client<span style="color: #666666">.</span>last_options<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;retrieval&quot;</span>, {})
    <span style="color: #008000; font-weight: bold">assert</span> retrieval<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;exclude&quot;</span>) <span style="color: #666666">==</span> [<span style="color: #BA2121">&quot;doc-a&quot;</span>]
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;doc-b&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> retrieval<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;include&quot;</span>, [])
    documents <span style="color: #666666">=</span> retrieval<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;documents&quot;</span>)
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">isinstance</span>(documents, <span style="color: #008000">list</span>) <span style="color: #AA22FF; font-weight: bold">and</span> documents
    <span style="color: #008000; font-weight: bold">assert</span> documents[<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;text&quot;</span>]
    <span style="color: #008000; font-weight: bold">assert</span> documents[<span style="color: #666666">0</span>][<span style="color: #BA2121">&quot;id&quot;</span>]

    window<span style="color: #666666">.</span>close()
</code></pre>
<h3 id="test_evidence_open_in_system_app">test_evidence_open_in_system_app(qt_app, tmp_path, monkeypatch, project_service)</h3>
<p>The function `test_evidence_open_in_system_app` tests the behavior of opening a document from an evidence panel within a main application window. It sets up a test environment with a dummy LMStudio client, a progress service, and a project service. A question is submitted to trigger the display of evidence, and then simulates clicking an &quot;open&quot; button on the first evidence item. The test verifies that the system attempts to open the correct local file path (`/tmp/doc_a.txt`) using `QDesktopServices.openUrl`. The function patches `QDesktopServices.openUrl` to capture the URL being opened and asserts that it matches the expected file path. Finally, the main window is closed.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_evidence_open_in_system_app</span>(qt_app, tmp_path, monkeypatch, project_service):
    settings_service <span style="color: #666666">=</span> build_settings_service(tmp_path, monkeypatch)
    progress_service <span style="color: #666666">=</span> ProgressService()
    client <span style="color: #666666">=</span> DummyLMStudioClient()
    export_service <span style="color: #666666">=</span> ExportService()
    backup_service <span style="color: #666666">=</span> BackupService(project_service)
    window <span style="color: #666666">=</span> MainWindow(
        settings_service<span style="color: #666666">=</span>settings_service,
        progress_service<span style="color: #666666">=</span>progress_service,
        lmstudio_client<span style="color: #666666">=</span>client,
        project_service<span style="color: #666666">=</span>project_service,
        export_service<span style="color: #666666">=</span>export_service,
        backup_service<span style="color: #666666">=</span>backup_service,
        enable_health_monitor<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
    )

    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>set_text(<span style="color: #BA2121">&quot;Launch source&quot;</span>)
    window<span style="color: #666666">.</span>question_input<span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()

    called: <span style="color: #008000">dict</span>[<span style="color: #008000">str</span>, QUrl] <span style="color: #666666">=</span> {}

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">fake_open</span>(url: QUrl) <span style="color: #666666">-&gt;</span> <span style="color: #008000">bool</span>:  <span style="color: #3D7B7B; font-style: italic"># pragma: no cover - executed in test</span>
        called[<span style="color: #BA2121">&quot;url&quot;</span>] <span style="color: #666666">=</span> url
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">True</span>

    monkeypatch<span style="color: #666666">.</span>setattr(<span style="color: #BA2121">&quot;PyQt6.QtGui.QDesktopServices.openUrl&quot;</span>, <span style="color: #008000">staticmethod</span>(fake_open))

    window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>select_index(<span style="color: #666666">0</span>)
    qt_app<span style="color: #666666">.</span>processEvents()
    row <span style="color: #666666">=</span> window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>_list<span style="color: #666666">.</span>itemWidget(window<span style="color: #666666">.</span>_evidence_panel<span style="color: #666666">.</span>_list<span style="color: #666666">.</span>item(<span style="color: #666666">0</span>))
    <span style="color: #008000; font-weight: bold">assert</span> row <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>
    row<span style="color: #666666">.</span>open_button<span style="color: #666666">.</span>click()
    qt_app<span style="color: #666666">.</span>processEvents()

    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #BA2121">&quot;url&quot;</span> <span style="color: #AA22FF; font-weight: bold">in</span> called
    <span style="color: #008000; font-weight: bold">assert</span> called[<span style="color: #BA2121">&quot;url&quot;</span>]<span style="color: #666666">.</span>toLocalFile() <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;/tmp/doc_a.txt&quot;</span>

    window<span style="color: #666666">.</span>close()
</code></pre>
<details>
<summary>Subfunction: fake_open(url: QUrl) -&gt; bool</summary>
<h4 id="fake_open">fake_open(url: QUrl) -&gt; bool</h4>
<p>The function `fake_open` takes a `QUrl` object as input and assigns it to a dictionary key `&quot;url&quot;` within a variable named `called`. It then returns `True`. This function appears to be a mock implementation used for testing purposes, likely to simulate opening a URL while recording the URL that was &quot;opened&quot; for verification in tests.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">fake_open</span>(url: QUrl) <span style="color: #666666">-&gt;</span> <span style="color: #008000">bool</span>:  <span style="color: #3D7B7B; font-style: italic"># pragma: no cover - executed in test</span>
        called[<span style="color: #BA2121">&quot;url&quot;</span>] <span style="color: #666666">=</span> url
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">True</span>
</code></pre>
</details>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>

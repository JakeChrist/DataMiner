<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>question_input_widget</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><details><summary>app</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="__main__.html">__main__</a></li><li><a href="config.html">config</a></li><li><a href="logging.html">logging</a></li><li><details><summary>ingest</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="preview.html">preview</a></li><li><a href="service.html">service</a></li><li><details><summary>parsers</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="docx_parser.html">docx_parser</a></li><li><a href="markdown_parser.html">markdown_parser</a></li><li><a href="pdf_parser.html">pdf_parser</a></li><li><a href="text_parser.html">text_parser</a></li></ul></details></li></ul></details></li><li><details><summary>retrieval</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="index.html">index</a></li><li><a href="search.html">search</a></li></ul></details></li><li><details><summary>services</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="backup_service.html">backup_service</a></li><li><a href="conversation_manager.html">conversation_manager</a></li><li><a href="conversation_settings.html">conversation_settings</a></li><li><a href="document_hierarchy.html">document_hierarchy</a></li><li><a href="export_service.html">export_service</a></li><li><a href="lmstudio_client.html">lmstudio_client</a></li><li><a href="progress_service.html">progress_service</a></li><li><a href="project_service.html">project_service</a></li><li><a href="settings_service.html">settings_service</a></li></ul></details></li><li><details><summary>storage</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="database.html">database</a></li></ul></details></li><li><details><summary>ui</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="answer_view.html">answer_view</a></li><li><a href="evidence_panel.html">evidence_panel</a></li><li><a href="main_window.html">main_window</a></li><li><a href="question_input_widget.html">question_input_widget</a></li></ul></details></li></ul></details></li><li><details><summary>tests</summary><ul><li><a href="test_dynamic_planning.html">test_dynamic_planning</a></li><li><a href="test_export_and_backup.html">test_export_and_backup</a></li><li><a href="test_ingest_service.html">test_ingest_service</a></li><li><a href="test_lmstudio_integration.html">test_lmstudio_integration</a></li><li><a href="test_parser_file_types.html">test_parser_file_types</a></li><li><a href="test_preview_service.html">test_preview_service</a></li><li><a href="test_project_service.html">test_project_service</a></li><li><a href="test_retrieval_index.html">test_retrieval_index</a></li><li><a href="test_search_service.html">test_search_service</a></li><li><a href="test_storage.html">test_storage</a></li><li><a href="test_ui_main_window.html">test_ui_main_window</a></li></ul></details></li></ul>
    </div>
    <div class="content">
        <h1>question_input_widget</h1>
        <p>The module defines a reusable widget for handling chat question input in a PyQt6-based application. The widget includes a text editor with history navigation support, scope filtering indicators, status messages, and control buttons for submitting questions, clearing input, and accessing settings. It manages user input, tracks conversation history, and integrates with connection and prerequisite states to enable or disable interactions. The widget supports compact and regular display modes, and updates its interface based on model settings and connection status.</p>
<h2 id="_HistoryTextEdit">Class: _HistoryTextEdit</h2>
<p>The `_HistoryTextEdit` class extends `QTextEdit` to provide specialized keyboard navigation for history management. It emits signals when specific key combinations are pressed: `submit_requested` on Ctrl+Enter, `history_previous_requested` on Up arrow when at the start of text, and `history_next_requested` on Down arrow when at the end of text. The class overrides `keyPressEvent` to intercept and handle these shortcuts while allowing other key events to propagate normally.</p>
<h3 id="keyPressEvent">Method: keyPressEvent(self, event) -&gt; None</h3>
<p>The `keyPressEvent` method handles specific keyboard interactions within the `_HistoryTextEdit` widget. It emits signals based on key combinations: pressing Ctrl+Enter triggers a submit request, while pressing the Up arrow at the start of the text emits a signal for navigating to the previous item in history, and pressing the Down arrow at the end of the text emits a signal for navigating to the next item in history. For all other key events, it delegates handling to the parent class.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">keyPressEvent</span>(<span style="color: #008000">self</span>, event) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:  <span style="color: #3D7B7B; font-style: italic"># type: ignore[override]</span>
        key <span style="color: #666666">=</span> event<span style="color: #666666">.</span>key()
        modifiers <span style="color: #666666">=</span> event<span style="color: #666666">.</span>modifiers()
        <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #AA22FF; font-weight: bold">in</span> {Qt<span style="color: #666666">.</span>Key<span style="color: #666666">.</span>Key_Return, Qt<span style="color: #666666">.</span>Key<span style="color: #666666">.</span>Key_Enter} <span style="color: #AA22FF; font-weight: bold">and</span> (
            modifiers <span style="color: #666666">&amp;</span> Qt<span style="color: #666666">.</span>KeyboardModifier<span style="color: #666666">.</span>ControlModifier
        ):
            event<span style="color: #666666">.</span>accept()
            <span style="color: #008000">self</span><span style="color: #666666">.</span>submit_requested<span style="color: #666666">.</span>emit()
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #666666">==</span> Qt<span style="color: #666666">.</span>Key<span style="color: #666666">.</span>Key_Up <span style="color: #AA22FF; font-weight: bold">and</span> modifiers <span style="color: #666666">==</span> Qt<span style="color: #666666">.</span>KeyboardModifier<span style="color: #666666">.</span>NoModifier:
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>textCursor()<span style="color: #666666">.</span>atStart():
                event<span style="color: #666666">.</span>accept()
                <span style="color: #008000">self</span><span style="color: #666666">.</span>history_previous_requested<span style="color: #666666">.</span>emit()
                <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #666666">==</span> Qt<span style="color: #666666">.</span>Key<span style="color: #666666">.</span>Key_Down <span style="color: #AA22FF; font-weight: bold">and</span> modifiers <span style="color: #666666">==</span> Qt<span style="color: #666666">.</span>KeyboardModifier<span style="color: #666666">.</span>NoModifier:
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>textCursor()<span style="color: #666666">.</span>atEnd():
                event<span style="color: #666666">.</span>accept()
                <span style="color: #008000">self</span><span style="color: #666666">.</span>history_next_requested<span style="color: #666666">.</span>emit()
                <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000">super</span>()<span style="color: #666666">.</span>keyPressEvent(event)
</code></pre>
<h2 id="QuestionInputWidget">Class: QuestionInputWidget</h2>
<p>The `QuestionInputWidget` class defines a composite Qt widget for entering questions, managing input history, and controlling associated actions like asking and clearing. It includes functionality for tracking user input, maintaining a history of entered text, and updating UI elements such as buttons and status indicators based on the widget&#x27;s state. The widget emits signals when a question is submitted or cleared, and supports settings configuration, scope filtering, and connection status updates.</p>
<h3 id="__init__">Method: __init__(self, parent=None) -&gt; None</h3>
<p>Initializes the `QuestionInputWidget` class, setting up the user interface components and connections for question input, history navigation, and button controls. The widget includes a text editor for input, scope and status indicators, settings and ask buttons, and manages input history and UI state. It configures layout, connects signals to slots for handling user interactions, and initializes internal state variables such as history, model name, and answer length. The widget is designed to integrate with a larger application for document processing and question-answering using local AI models.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, parent<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">super</span>()<span style="color: #666666">.</span><span style="color: #0000FF">__init__</span>(parent)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>setObjectName(<span style="color: #BA2121">&quot;questionInput&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_history: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_prerequisites_met <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_status_message: <span style="color: #008000">str</span> <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_busy <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_settings_menu: QMenu <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_model_name <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;lmstudio&quot;</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_answer_length <span style="color: #666666">=</span> AnswerLength<span style="color: #666666">.</span>NORMAL

        layout <span style="color: #666666">=</span> QVBoxLayout(<span style="color: #008000">self</span>)
        layout<span style="color: #666666">.</span>setContentsMargins(<span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>)
        layout<span style="color: #666666">.</span>setSpacing(<span style="color: #666666">6</span>)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor <span style="color: #666666">=</span> _HistoryTextEdit(<span style="color: #008000">self</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>setAcceptRichText(<span style="color: #008000; font-weight: bold">False</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>setPlaceholderText(<span style="color: #BA2121">&quot;Ask a question about your data (Ctrl+Enter to send)&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>textChanged<span style="color: #666666">.</span>connect(<span style="color: #008000">self</span><span style="color: #666666">.</span>_update_button_state)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>submit_requested<span style="color: #666666">.</span>connect(<span style="color: #008000">self</span><span style="color: #666666">.</span>_trigger_ask)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>history_previous_requested<span style="color: #666666">.</span>connect(<span style="color: #008000">self</span><span style="color: #666666">.</span>_recall_previous)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>history_next_requested<span style="color: #666666">.</span>connect(<span style="color: #008000">self</span><span style="color: #666666">.</span>_recall_next)
        layout<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>editor, <span style="color: #666666">1</span>)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>_top_row <span style="color: #666666">=</span> QHBoxLayout()
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_top_row<span style="color: #666666">.</span>setSpacing(<span style="color: #666666">6</span>)
        layout<span style="color: #666666">.</span>addLayout(<span style="color: #008000">self</span><span style="color: #666666">.</span>_top_row)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button <span style="color: #666666">=</span> QToolButton(<span style="color: #008000">self</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setObjectName(<span style="color: #BA2121">&quot;scopeChip&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">False</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setCursor(Qt<span style="color: #666666">.</span>CursorShape<span style="color: #666666">.</span>PointingHandCursor)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setToolTip(<span style="color: #BA2121">&quot;Scope: entire corpus&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>clicked<span style="color: #666666">.</span>connect(<span style="color: #008000; font-weight: bold">lambda</span>: <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_cleared<span style="color: #666666">.</span>emit())
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_top_row<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label <span style="color: #666666">=</span> QLabel(<span style="color: #BA2121">&quot;&quot;</span>, <span style="color: #008000">self</span>)
        font <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>font()
        font<span style="color: #666666">.</span>setPointSizeF(font<span style="color: #666666">.</span>pointSizeF() <span style="color: #666666">-</span> <span style="color: #666666">1</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>setFont(font)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">False</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_top_row<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>status_label, <span style="color: #666666">1</span>)

        buttons_row <span style="color: #666666">=</span> QHBoxLayout()
        buttons_row<span style="color: #666666">.</span>setSpacing(<span style="color: #666666">8</span>)
        layout<span style="color: #666666">.</span>addLayout(buttons_row)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_buttons_row <span style="color: #666666">=</span> buttons_row

        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill <span style="color: #666666">=</span> QLabel(<span style="color: #BA2121">&quot;&quot;</span>, <span style="color: #008000">self</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>setObjectName(<span style="color: #BA2121">&quot;statusPill&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">False</span>)
        buttons_row<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill)
        buttons_row<span style="color: #666666">.</span>addStretch(<span style="color: #666666">1</span>)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button <span style="color: #666666">=</span> QToolButton(<span style="color: #008000">self</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setObjectName(<span style="color: #BA2121">&quot;settingsChip&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setPopupMode(QToolButton<span style="color: #666666">.</span>ToolButtonPopupMode<span style="color: #666666">.</span>InstantPopup)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setToolButtonStyle(Qt<span style="color: #666666">.</span>ToolButtonStyle<span style="color: #666666">.</span>ToolButtonTextOnly)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setCursor(Qt<span style="color: #666666">.</span>CursorShape<span style="color: #666666">.</span>PointingHandCursor)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setEnabled(<span style="color: #008000; font-weight: bold">False</span>)
        buttons_row<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button <span style="color: #666666">=</span> QPushButton(<span style="color: #BA2121">&quot;Ask&quot;</span>, <span style="color: #008000">self</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>setDefault(<span style="color: #008000; font-weight: bold">True</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>clicked<span style="color: #666666">.</span>connect(<span style="color: #008000">self</span><span style="color: #666666">.</span>_trigger_ask)
        buttons_row<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>clear_button <span style="color: #666666">=</span> QPushButton(<span style="color: #BA2121">&quot;Clear&quot;</span>, <span style="color: #008000">self</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>clear_button<span style="color: #666666">.</span>clicked<span style="color: #666666">.</span>connect(<span style="color: #008000">self</span><span style="color: #666666">.</span>clear)
        buttons_row<span style="color: #666666">.</span>addWidget(<span style="color: #008000">self</span><span style="color: #666666">.</span>clear_button)

        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_button_state()
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_settings_summary()
</code></pre>
<h3 id="text">Method: text(self) -&gt; str</h3>
<p>The function `text` retrieves the plain text content from the `self.editor` widget, strips any leading or trailing whitespace, and returns the resulting string.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">text</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000">str</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>toPlainText()<span style="color: #666666">.</span>strip()
</code></pre>
<h3 id="set_text">Method: set_text(self, text: str) -&gt; None</h3>
<p>Sets the plain text content of the editor to the provided string, positions the cursor at the end of the text, and updates the state of associated buttons.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_text</span>(<span style="color: #008000">self</span>, text: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>setPlainText(text)
        cursor <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>textCursor()
        cursor<span style="color: #666666">.</span>movePosition(cursor<span style="color: #666666">.</span>MoveOperation<span style="color: #666666">.</span>End)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>setTextCursor(cursor)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_button_state()
</code></pre>
<h3 id="clear">Method: clear(self) -&gt; None</h3>
<p>The `clear` method clears the content of the editor, resets the history index to the end of the history list, updates the state of buttons based on the new history index, and emits a `cleared` signal.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">clear</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:  <span style="color: #3D7B7B; font-style: italic"># type: ignore[override]</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>clear()
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">=</span> <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>_history)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_button_state()
        <span style="color: #008000">self</span><span style="color: #666666">.</span>cleared<span style="color: #666666">.</span>emit()
</code></pre>
<h3 id="set_busy">Method: set_busy(self, busy: bool) -&gt; None</h3>
<p>The `set_busy` method updates the widget&#x27;s state to reflect whether it is busy. It sets the `_busy` attribute, makes the editor read-only and non-editable when busy, disables the clear button, and updates the state of the update button.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_busy</span>(<span style="color: #008000">self</span>, busy: <span style="color: #008000">bool</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_busy <span style="color: #666666">=</span> <span style="color: #008000">bool</span>(busy)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>setReadOnly(<span style="color: #008000">self</span><span style="color: #666666">.</span>_busy)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>setEnabled(<span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_busy)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>clear_button<span style="color: #666666">.</span>setEnabled(<span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_busy)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_button_state()
</code></pre>
<h3 id="set_prerequisites_met">Method: set_prerequisites_met(self, ok: bool, message: str | None=None) -&gt; None</h3>
<p>The function `set_prerequisites_met` updates the widget&#x27;s internal state to reflect whether prerequisites for question input are satisfied. It sets a boolean flag `_prerequisites_met` and stores an optional status message `_status_message`. If prerequisites are met or no message is provided, the status label is hidden. Otherwise, the message is displayed, truncated if necessary to fit within a specified width, and the label is made visible. Finally, it updates the state of the input button based on the updated prerequisites.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_prerequisites_met</span>(<span style="color: #008000">self</span>, ok: <span style="color: #008000">bool</span>, message: <span style="color: #008000">str</span> <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_prerequisites_met <span style="color: #666666">=</span> <span style="color: #008000">bool</span>(ok)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_status_message <span style="color: #666666">=</span> message
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_prerequisites_met <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #AA22FF; font-weight: bold">not</span> message:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">False</span>)
        <span style="color: #008000; font-weight: bold">else</span>:
            display <span style="color: #666666">=</span> message<span style="color: #666666">.</span>strip()
            <span style="color: #008000; font-weight: bold">if</span> display:
                metrics <span style="color: #666666">=</span> QFontMetrics(<span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>font())
                elided <span style="color: #666666">=</span> metrics<span style="color: #666666">.</span>elidedText(display, Qt<span style="color: #666666">.</span>TextElideMode<span style="color: #666666">.</span>ElideMiddle, <span style="color: #666666">320</span>)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>setText(elided)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>status_label<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">True</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_button_state()
</code></pre>
<h3 id="set_settings_menu">Method: set_settings_menu(self, menu: QMenu | None) -&gt; None</h3>
<p>The function `set_settings_menu` assigns a provided `QMenu` object to the internal `_settings_menu` attribute of the `QuestionInputWidget` class. It also associates this menu with the `settings_button` widget, enabling the button only if the provided menu is not `None`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_settings_menu</span>(<span style="color: #008000">self</span>, menu: QMenu <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_settings_menu <span style="color: #666666">=</span> menu
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setMenu(menu)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setEnabled(menu <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000; font-weight: bold">None</span>)
</code></pre>
<h3 id="set_model_name">Method: set_model_name(self, name: str) -&gt; None</h3>
<p>The function `set_model_name` updates the model name stored in the instance, but only if the new name is different from the current one. It cleanses the input by stripping whitespace and ensures the update occurs only when necessary. After updating the model name, it triggers a summary update for the settings.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_model_name</span>(<span style="color: #008000">self</span>, name: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        cleaned <span style="color: #666666">=</span> <span style="color: #008000">str</span>(name)<span style="color: #666666">.</span>strip()
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> cleaned:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000; font-weight: bold">if</span> cleaned <span style="color: #666666">==</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_model_name:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_model_name <span style="color: #666666">=</span> cleaned
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_settings_summary()
</code></pre>
<h3 id="set_answer_length">Method: set_answer_length(self, preset: AnswerLength) -&gt; None</h3>
<p>The function `set_answer_length` updates the answer length preset for the question input widget. It accepts an argument of type `AnswerLength`, validates its type, and checks if the new value differs from the current setting. If both conditions are met, it updates the internal `_answer_length` attribute and triggers an update to the settings summary by calling `_update_settings_summary()`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_answer_length</span>(<span style="color: #008000">self</span>, preset: AnswerLength) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">isinstance</span>(preset, AnswerLength):
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000; font-weight: bold">if</span> preset <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_answer_length:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_answer_length <span style="color: #666666">=</span> preset
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_update_settings_summary()
</code></pre>
<h3 id="set_density">Method: set_density(self, density: str) -&gt; None</h3>
<p>The function `set_density` adjusts the spacing and margins of the widget&#x27;s layout and related sub-rows based on the specified density mode. When the mode is set to &quot;compact&quot;, it applies smaller spacing and no margins; otherwise, it uses larger spacing and margins. The function modifies the vertical layout&#x27;s spacing and content margins, as well as the spacing for `_top_row` and `_buttons_row`.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_density</span>(<span style="color: #008000">self</span>, density: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        mode <span style="color: #666666">=</span> <span style="color: #008000">str</span>(density)<span style="color: #666666">.</span>lower()
        spacing <span style="color: #666666">=</span> <span style="color: #666666">4</span> <span style="color: #008000; font-weight: bold">if</span> mode <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;compact&quot;</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">8</span>
        margins <span style="color: #666666">=</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">if</span> mode <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;compact&quot;</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">4</span>
        layout <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>layout()
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(layout, QVBoxLayout):
            layout<span style="color: #666666">.</span>setSpacing(spacing)
            layout<span style="color: #666666">.</span>setContentsMargins(margins, margins, margins, margins)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_top_row<span style="color: #666666">.</span>setSpacing(spacing)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_buttons_row<span style="color: #666666">.</span>setSpacing(spacing <span style="color: #666666">+</span> <span style="color: #666666">2</span>)
</code></pre>
<h3 id="update_scope_chip">Method: update_scope_chip(self, include_count: int, exclude_count: int) -&gt; None</h3>
<p>Updates the scope chip display on the widget based on include and exclude counts. If both counts are zero or less, the scope button is hidden with a tooltip indicating the entire corpus is included. Otherwise, it constructs a label showing the counts of included and excluded items, updates the button text and tooltip, and makes the button visible.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">update_scope_chip</span>(<span style="color: #008000">self</span>, include_count: <span style="color: #008000">int</span>, exclude_count: <span style="color: #008000">int</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> include_count <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">and</span> exclude_count <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">False</span>)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setToolTip(<span style="color: #BA2121">&quot;Scope: entire corpus&quot;</span>)
            <span style="color: #008000; font-weight: bold">return</span>
        parts: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []
        <span style="color: #008000; font-weight: bold">if</span> include_count <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
            parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;+</span><span style="color: #A45A77; font-weight: bold">{</span>include_count<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
        <span style="color: #008000; font-weight: bold">if</span> exclude_count <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
            parts<span style="color: #666666">.</span>append(<span style="color: #BA2121">f&quot;-</span><span style="color: #A45A77; font-weight: bold">{</span>exclude_count<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>)
        label <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Scope &quot;</span> <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; ¬∑ &quot;</span><span style="color: #666666">.</span>join(parts)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setText(label)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setToolTip(<span style="color: #BA2121">&quot;Clear scope filters&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>scope_button<span style="color: #666666">.</span>setVisible(<span style="color: #008000; font-weight: bold">True</span>)
</code></pre>
<h3 id="set_connection_state">Method: set_connection_state(self, state: ConnectionState) -&gt; None</h3>
<p>The function `set_connection_state` updates the connection status display of the `QuestionInputWidget` based on the provided `ConnectionState` object. If the connection is established, it sets the status pill to &quot;LMStudio Connected&quot; with a connected state and displays the associated message or defaults to &quot;Connected to LMStudio&quot;. If the connection is not established, it sets the status pill to either &quot;error&quot; or &quot;warning&quot; state depending on whether a message is provided, displaying the message or defaulting to &quot;LMStudio Offline&quot; or &quot;LMStudio is not responding.&quot; The function uses the `_set_status_pill` method to render the visual status indicator with appropriate label, severity, and tooltip.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_connection_state</span>(<span style="color: #008000">self</span>, state: ConnectionState) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> state<span style="color: #666666">.</span>connected:
            tooltip <span style="color: #666666">=</span> state<span style="color: #666666">.</span>message <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;Connected to LMStudio&quot;</span>
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_set_status_pill(<span style="color: #BA2121">&quot;LMStudio Connected&quot;</span>, <span style="color: #BA2121">&quot;connected&quot;</span>, tooltip)
        <span style="color: #008000; font-weight: bold">else</span>:
            severity <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;error&quot;</span> <span style="color: #008000; font-weight: bold">if</span> state<span style="color: #666666">.</span>message <span style="color: #008000; font-weight: bold">else</span> <span style="color: #BA2121">&quot;warning&quot;</span>
            label <span style="color: #666666">=</span> state<span style="color: #666666">.</span>message <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;LMStudio Offline&quot;</span>
            tooltip <span style="color: #666666">=</span> state<span style="color: #666666">.</span>message <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;LMStudio is not responding.&quot;</span>
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_set_status_pill(label, severity, tooltip)
</code></pre>
<h3 id="set_status_message">Method: set_status_message(self, text: str, level: str=&#x27;info&#x27;) -&gt; None</h3>
<p>The function `set_status_message` updates the status message displayed in the user interface with the provided text and assigns it a visual state based on the specified level. It normalizes the input level to one of four predefined states: &quot;info&quot;, &quot;warning&quot;, &quot;error&quot;, or &quot;connected&quot;. The function maps &quot;warning&quot; and &quot;warn&quot; to &quot;warning&quot;, &quot;error&quot; and &quot;danger&quot; to &quot;error&quot;, and &quot;success&quot; and &quot;ok&quot; to &quot;connected&quot;. All other inputs default to &quot;info&quot;. Finally, it calls `_set_status_pill` with the text and the determined state to update the UI.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_status_message</span>(<span style="color: #008000">self</span>, text: <span style="color: #008000">str</span>, level: <span style="color: #008000">str</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;info&quot;</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        normalized <span style="color: #666666">=</span> <span style="color: #008000">str</span>(level)<span style="color: #666666">.</span>lower()
        state <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;info&quot;</span>
        <span style="color: #008000; font-weight: bold">if</span> normalized <span style="color: #AA22FF; font-weight: bold">in</span> {<span style="color: #BA2121">&quot;warning&quot;</span>, <span style="color: #BA2121">&quot;warn&quot;</span>}:
            state <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;warning&quot;</span>
        <span style="color: #008000; font-weight: bold">elif</span> normalized <span style="color: #AA22FF; font-weight: bold">in</span> {<span style="color: #BA2121">&quot;error&quot;</span>, <span style="color: #BA2121">&quot;danger&quot;</span>}:
            state <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;error&quot;</span>
        <span style="color: #008000; font-weight: bold">elif</span> normalized <span style="color: #AA22FF; font-weight: bold">in</span> {<span style="color: #BA2121">&quot;success&quot;</span>, <span style="color: #BA2121">&quot;ok&quot;</span>}:
            state <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;connected&quot;</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_set_status_pill(text, state)
</code></pre>
<h3 id="_set_status_pill">Method: _set_status_pill(self, text: str, state: str, tooltip: str | None=None) -&gt; None</h3>
<p>The function `_set_status_pill` updates the display and properties of a status indicator widget (`status_pill`) within the `QuestionInputWidget` class. It sets the text content, visibility, tooltip, and CSS state property of the widget based on provided parameters. The text is stripped of leading/trailing whitespace if it is a string. The widget&#x27;s style is refreshed to apply any visual changes associated with the new state.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_set_status_pill</span>(<span style="color: #008000">self</span>, text: <span style="color: #008000">str</span>, state: <span style="color: #008000">str</span>, tooltip: <span style="color: #008000">str</span> <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        display <span style="color: #666666">=</span> text<span style="color: #666666">.</span>strip() <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(text, <span style="color: #008000">str</span>) <span style="color: #008000; font-weight: bold">else</span> <span style="color: #BA2121">&quot;&quot;</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>setText(display)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>setVisible(<span style="color: #008000">bool</span>(display))
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>setToolTip(tooltip <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>setProperty(<span style="color: #BA2121">&quot;state&quot;</span>, state <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #BA2121">&quot;info&quot;</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>style()<span style="color: #666666">.</span>unpolish(<span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill<span style="color: #666666">.</span>style()<span style="color: #666666">.</span>polish(<span style="color: #008000">self</span><span style="color: #666666">.</span>status_pill)
</code></pre>
<h3 id="_update_settings_summary">Method: _update_settings_summary(self) -&gt; None</h3>
<p>Updates the text of `settings_button` to display a summary combining the current model name and answer length setting. The answer length value is converted to title case for display.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_update_settings_summary</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        length_label <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_answer_length<span style="color: #666666">.</span>value<span style="color: #666666">.</span>title()
        summary <span style="color: #666666">=</span> <span style="color: #BA2121">f&quot;</span><span style="color: #A45A77; font-weight: bold">{</span><span style="color: #008000">self</span><span style="color: #666666">.</span>_model_name<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> ¬∑ </span><span style="color: #A45A77; font-weight: bold">{</span>length_label<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121">&quot;</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>settings_button<span style="color: #666666">.</span>setText(summary)
</code></pre>
<h3 id="_trigger_ask">Method: _trigger_ask(self) -&gt; None</h3>
<p>The function `_trigger_ask` is responsible for initiating a question-answering request within the `QuestionInputWidget` class. It first checks if the widget is not in a busy state, if the input text is present, and if all prerequisites are met. If these conditions are satisfied, it stores the entered text, clears the input field, and emits a signal `ask_requested` with the text as an argument to notify other components of the new question.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_trigger_ask</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_busy:
            <span style="color: #008000; font-weight: bold">return</span>
        text <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>text()
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> text:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_prerequisites_met:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_remember_entry(text)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>clear()
        <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_requested<span style="color: #666666">.</span>emit(text)
</code></pre>
<h3 id="_remember_entry">Method: _remember_entry(self, text: str) -&gt; None</h3>
<p>The function `_remember_entry` stores a given text string in the widget&#x27;s history list, appending it only if it is non-empty and not already the last entry. It then updates the history index to point to the end of the history list. This implements functionality for tracking input history, likely for use in a text input field with navigation through previous entries.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_remember_entry</span>(<span style="color: #008000">self</span>, text: <span style="color: #008000">str</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> text <span style="color: #AA22FF; font-weight: bold">and</span> (<span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_history <span style="color: #AA22FF; font-weight: bold">or</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_history[<span style="color: #666666">-1</span>] <span style="color: #666666">!=</span> text):
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_history<span style="color: #666666">.</span>append(text)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">=</span> <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>_history)
</code></pre>
<h3 id="_recall_previous">Method: _recall_previous(self) -&gt; None</h3>
<p>The function `_recall_previous` navigates backward through the history of questions within the `QuestionInputWidget`. It decrements the current history index and applies the previous question from the history, if available. If the history is empty, the function returns without performing any action.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_recall_previous</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_history:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">=</span> <span style="color: #008000">max</span>(<span style="color: #666666">0</span>, <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">-</span> <span style="color: #666666">1</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_apply_history()
</code></pre>
<h3 id="_recall_next">Method: _recall_next(self) -&gt; None</h3>
<p>The function `_recall_next` navigates forward through the history of question inputs within the `QuestionInputWidget`. It increments the current history index and applies the next item from the history, if available. If the history is empty, the function returns without action. The history index is capped at the length of the history to prevent exceeding its bounds.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_recall_next</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_history:
            <span style="color: #008000; font-weight: bold">return</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">=</span> <span style="color: #008000">min</span>(<span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>_history), <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">+</span> <span style="color: #666666">1</span>)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_apply_history()
</code></pre>
<h3 id="_apply_history">Method: _apply_history(self) -&gt; None</h3>
<p>The function `_apply_history` updates the text in the widget&#x27;s editor based on the current index in the history list. If the index is valid, it sets the editor&#x27;s text to the value at that index in the history; otherwise, it clears the editor.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_apply_history</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index <span style="color: #666666">&lt;</span> <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>_history):
            <span style="color: #008000">self</span><span style="color: #666666">.</span>set_text(<span style="color: #008000">self</span><span style="color: #666666">.</span>_history[<span style="color: #008000">self</span><span style="color: #666666">.</span>_history_index])
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>editor<span style="color: #666666">.</span>clear()
</code></pre>
<h3 id="_update_button_state">Method: _update_button_state(self) -&gt; None</h3>
<p>The function `_update_button_state` updates the enabled state and tooltip of the `ask_button` based on the current state of the widget. It enables the button only if there is text in the input, prerequisites are met, and the widget is not busy. If prerequisites are not met, it sets the button&#x27;s tooltip to a status message; otherwise, it clears the tooltip.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_update_button_state</span>(<span style="color: #008000">self</span>) <span style="color: #666666">-&gt;</span> <span style="color: #008000; font-weight: bold">None</span>:
        has_text <span style="color: #666666">=</span> <span style="color: #008000">bool</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>text())
        enabled <span style="color: #666666">=</span> has_text <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_prerequisites_met <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_busy
        <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>setEnabled(enabled)
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_prerequisites_met <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_status_message:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>setToolTip(<span style="color: #008000">self</span><span style="color: #666666">.</span>_status_message)
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>ask_button<span style="color: #666666">.</span>setToolTip(<span style="color: #BA2121">&quot;&quot;</span>)
</code></pre>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>

<!-- Generated by DocGen-LM -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>markdown_parser</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <button id="sidebar-toggle">Menu</button>
    <div class="sidebar">
        <h2>Navigation</h2>
        <ul><li><a href="index.html"><strong>üè† Project Overview</strong></a></li><li><details><summary>app</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="__main__.html">__main__</a></li><li><a href="config.html">config</a></li><li><a href="logging.html">logging</a></li><li><details><summary>ingest</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="preview.html">preview</a></li><li><a href="service.html">service</a></li><li><details><summary>parsers</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="docx_parser.html">docx_parser</a></li><li><a href="markdown_parser.html">markdown_parser</a></li><li><a href="pdf_parser.html">pdf_parser</a></li><li><a href="text_parser.html">text_parser</a></li></ul></details></li></ul></details></li><li><details><summary>retrieval</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="index.html">index</a></li><li><a href="search.html">search</a></li></ul></details></li><li><details><summary>services</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="backup_service.html">backup_service</a></li><li><a href="conversation_manager.html">conversation_manager</a></li><li><a href="conversation_settings.html">conversation_settings</a></li><li><a href="document_hierarchy.html">document_hierarchy</a></li><li><a href="export_service.html">export_service</a></li><li><a href="lmstudio_client.html">lmstudio_client</a></li><li><a href="progress_service.html">progress_service</a></li><li><a href="project_service.html">project_service</a></li><li><a href="settings_service.html">settings_service</a></li></ul></details></li><li><details><summary>storage</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="database.html">database</a></li></ul></details></li><li><details><summary>ui</summary><ul><li><a href="__init__.html">__init__</a></li><li><a href="answer_view.html">answer_view</a></li><li><a href="evidence_panel.html">evidence_panel</a></li><li><a href="main_window.html">main_window</a></li><li><a href="question_input_widget.html">question_input_widget</a></li></ul></details></li></ul></details></li><li><details><summary>tests</summary><ul><li><a href="test_dynamic_planning.html">test_dynamic_planning</a></li><li><a href="test_export_and_backup.html">test_export_and_backup</a></li><li><a href="test_ingest_service.html">test_ingest_service</a></li><li><a href="test_lmstudio_integration.html">test_lmstudio_integration</a></li><li><a href="test_parser_file_types.html">test_parser_file_types</a></li><li><a href="test_preview_service.html">test_preview_service</a></li><li><a href="test_project_service.html">test_project_service</a></li><li><a href="test_retrieval_index.html">test_retrieval_index</a></li><li><a href="test_search_service.html">test_search_service</a></li><li><a href="test_storage.html">test_storage</a></li><li><a href="test_ui_main_window.html">test_ui_main_window</a></li></ul></details></li></ul>
    </div>
    <div class="content">
        <h1>markdown_parser</h1>
        <p>Module defines a Markdown parser that processes files into structured sections based on heading hierarchy. It reads text content from a file path, identifies heading lines using a regular expression, and organizes content into document sections. Each section contains a title, level, and content. The parser preserves the hierarchical structure of headings and returns a parsed document object with metadata including format, heading count, and page content.</p>
<h2>Functions</h2>
<h3 id="parse_markdown">parse_markdown(path: Path) -&gt; ParsedDocument</h3>
<p>The function `parse_markdown` reads a Markdown file from a given path and parses its content into structured sections based on heading levels. It processes each line of the file, identifying headings using a regular expression and organizing subsequent lines into sections accordingly. Sections without content or title are filtered out. The function returns a `ParsedDocument` object containing the combined text, metadata including the format and number of headings, a list of document sections, and page content derived from the file&#x27;s body.</p>
<pre><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">parse_markdown</span>(path: Path) <span style="color: #666666">-&gt;</span> ParsedDocument:
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Parse a Markdown file into sections based on heading levels.&quot;&quot;&quot;</span>

    text <span style="color: #666666">=</span> path<span style="color: #666666">.</span>read_text(encoding<span style="color: #666666">=</span><span style="color: #BA2121">&quot;utf-8&quot;</span>)
    sections: <span style="color: #008000">list</span>[DocumentSection] <span style="color: #666666">=</span> []
    current_section: DocumentSection <span style="color: #666666">|</span> <span style="color: #008000; font-weight: bold">None</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
    body_lines: <span style="color: #008000">list</span>[<span style="color: #008000">str</span>] <span style="color: #666666">=</span> []

    <span style="color: #008000; font-weight: bold">for</span> line <span style="color: #AA22FF; font-weight: bold">in</span> text<span style="color: #666666">.</span>splitlines():
        match <span style="color: #666666">=</span> _HEADING_RE<span style="color: #666666">.</span>match(line<span style="color: #666666">.</span>strip())
        <span style="color: #008000; font-weight: bold">if</span> match:
            level <span style="color: #666666">=</span> <span style="color: #008000">len</span>(match<span style="color: #666666">.</span>group(<span style="color: #BA2121">&quot;level&quot;</span>))
            title <span style="color: #666666">=</span> match<span style="color: #666666">.</span>group(<span style="color: #BA2121">&quot;title&quot;</span>)<span style="color: #666666">.</span>strip()
            current_section <span style="color: #666666">=</span> DocumentSection(title<span style="color: #666666">=</span>title, content<span style="color: #666666">=</span><span style="color: #BA2121">&quot;&quot;</span>, level<span style="color: #666666">=</span>level)
            sections<span style="color: #666666">.</span>append(current_section)
            <span style="color: #008000; font-weight: bold">continue</span>
        <span style="color: #008000; font-weight: bold">if</span> current_section <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
            current_section <span style="color: #666666">=</span> DocumentSection(title<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>, content<span style="color: #666666">=</span><span style="color: #BA2121">&quot;&quot;</span>)
            sections<span style="color: #666666">.</span>append(current_section)
        current_section<span style="color: #666666">.</span>content <span style="color: #666666">+=</span> (<span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span> <span style="color: #008000; font-weight: bold">if</span> current_section<span style="color: #666666">.</span>content <span style="color: #008000; font-weight: bold">else</span> <span style="color: #BA2121">&quot;&quot;</span>) <span style="color: #666666">+</span> line<span style="color: #666666">.</span>rstrip()
        body_lines<span style="color: #666666">.</span>append(line<span style="color: #666666">.</span>rstrip())

    sections <span style="color: #666666">=</span> [section <span style="color: #008000; font-weight: bold">for</span> section <span style="color: #AA22FF; font-weight: bold">in</span> sections <span style="color: #008000; font-weight: bold">if</span> section<span style="color: #666666">.</span>content <span style="color: #AA22FF; font-weight: bold">or</span> section<span style="color: #666666">.</span>title]
    combined <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #AA5D1F; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(body_lines)
    pages <span style="color: #666666">=</span> [PageContent(number<span style="color: #666666">=1</span>, text<span style="color: #666666">=</span>combined)]
    metadata <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;format&quot;</span>: <span style="color: #BA2121">&quot;markdown&quot;</span>, <span style="color: #BA2121">&quot;heading_count&quot;</span>: <span style="color: #008000">len</span>([s <span style="color: #008000; font-weight: bold">for</span> s <span style="color: #AA22FF; font-weight: bold">in</span> sections <span style="color: #008000; font-weight: bold">if</span> s<span style="color: #666666">.</span>title])}
    <span style="color: #008000; font-weight: bold">return</span> ParsedDocument(text<span style="color: #666666">=</span>combined, metadata<span style="color: #666666">=</span>metadata, sections<span style="color: #666666">=</span>sections, pages<span style="color: #666666">=</span>pages)
</code></pre>
    </div>
    <script src="static/toggle.js"></script>
</body>
</html>
